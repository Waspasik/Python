# –î–Ω–µ–≤–Ω–∏–∫ –∫–æ—Å–º–æ–Ω–∞–≤—Ç–∞ üå∂Ô∏è
# –í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª diary.txt, –≤ –∫–æ—Ç–æ—Ä—ã–π –∫–æ—Å–º–æ–Ω–∞–≤—Ç –∑–∞–ø–∏—Å—ã–≤–∞–ª –Ω–µ–±–æ–ª—å—à–∏–µ
# –æ—Ç—á—ë—Ç—ã –∑–∞ –¥–µ–Ω—å. –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –æ—Ç—á—ë—Ç –æ–Ω –º–æ–≥ –∑–∞–ø–∏—Å–∞—Ç—å –ª–∏–±–æ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞, –ª–∏–±–æ –≤
# —Å–µ—Ä–µ–¥–∏–Ω—É, –ª–∏–±–æ –≤ –∫–æ–Ω–µ—Ü. –í—Å–µ –æ—Ç—á–µ—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π. –ö–∞–∂–¥—ã–π
# –Ω–æ–≤—ã–π –æ—Ç—á—ë—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD.MM.YYYY; HH:MM,
# –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–π —Å–ª–µ–¥—É—é—Ç —Å–æ–±—ã—Ç–∏—è, –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–∏–µ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –¥–µ–Ω—å:

# –ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∫–æ—Å–º–æ–Ω–∞–≤—Ç–∞ –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º
# –ø–æ—Ä—è–¥–∫–µ –∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±—ã —Ñ–∞–π–ª diary.txt –∏–º–µ–ª –≤–∏–¥:

# 13.02.1994; 18:49
# –£–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –Ω–∞–±–ª—é–¥–∞–µ–º –Ω–∞ —Ç–µ–Ω–µ–≤–æ–π —á–∞—Å—Ç–∏ –æ—Ä–±–∏—Ç—ã –≤ —Ä–∞–π–æ–Ω–µ –ö–∞–Ω–∞–¥—ã –º–æ—â–Ω–µ–π—à–µ–µ –ø–æ–ª—è—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ.
# –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –ø–æ—Ä–∞–∂–∞—é—Ç –º–∞—Å—à—Ç–∞–±—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–≥–æ. –ü–æ–¥ –Ω–∞–º–∏ –æ–≥—Ä–æ–º–Ω–∞—è –∑–µ–ª–µ–Ω–æ-—Ä–æ–∑–æ–≤–∞—è ¬´–∑–º–µ—è¬ª.

# 03.02.1994; 20:18
# –°–µ–≥–æ–¥–Ω—è –Ω–∞–±–ª—é–¥–∞–ª–∏ –∏ —Å–Ω—è–ª–∏ –Ω–∞ –≤–∏–¥–µ–æ —Å–ª–µ–¥ –®–∞—Ç—Ç–ª–∞ –ø–æ—Å–ª–µ –≤—ã–≤–µ–¥–µ–Ω–∏—è, –¥—ã–º–∏—Ç –æ–Ω –ø—Ä–∏–ª–∏—á–Ω–æ.
# –ì–æ—Ç–æ–≤–∏–º—Å—è –∫ —Ä–∞–¥–∏–æ–ª—é–±–∏—Ç–µ–ª—å—Å–∫–æ–π —Å–≤—è–∑–∏ —Å —ç–∫–∏–ø–∞–∂–µ–º –®–∞—Ç—Ç–ª–∞ –∏, –∫–æ–Ω–µ—á–Ω–æ, —Å –°–µ—Ä–≥–µ–µ–º.
# –ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ —Å–µ–∞–Ω—Å—É —Å–≤—è–∑–∏ —Å –®–∞—Ç—Ç–ª–æ–º –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª—Å—è —Å –†–∏—Ç–æ–π, —Ä–∞–¥–∏–æ–ª—é–±–∏—Ç–µ–ª–µ–º –∏–∑ –ê–≤—Å—Ç—Ä–∞–ª–∏–∏.
# –û–Ω–∞ –Ω–µ–º–Ω–æ–≥–æ –≥–æ–≤–æ—Ä–∏—Ç –ø–æ-—Ä—É—Å—Å–∫–∏ –∏ –æ—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ —Å–ª—ã—à–∞—Ç—å —Ä–æ–¥–Ω—É—é —Ä–µ—á—å.

 #12.02.1994; 17:17
# –°–µ–≥–æ–¥–Ω—è –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–±—Ä–æ—Å–æ–º —á–µ—Ä–µ–∑ —Å–ø—É—Ç–Ω–∏–∫ —Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä –≤–∏–¥–µ–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–Ω—è—Ç–æ–º—É –Ω–∞–º–∏ —Å–ª–µ–¥—É –®–∞—Ç—Ç–ª–∞.
# –ö–∞–∫ —Å–æ–æ–±—â–∏–ª –Ω–∞–º –¶–£–ü, –≤ –©–µ–ª–∫–æ–≤–µ —Ö–æ–ª–æ–¥–Ω–æ, –≤—Å–µ –∑–∞–º–µ—Ä–∑–ª–æ, –∞–Ω—Ç–µ–Ω–Ω–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç...
# –í—Å–µ —ç—Ç–æ –Ω–∞–≤–æ–¥–∏—Ç –Ω–∞ –≥—Ä—É—Å—Ç–Ω—ã–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –æ –Ω–∞—à–µ–π –±–µ–∑–æ–ª–∞–±–µ—Ä–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑—Ä—É—Ö–µ.

# —Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –±—ã –≤—ã–≤–µ—Å—Ç–∏:

# 03.02.1994; 20:18
# –°–µ–≥–æ–¥–Ω—è –Ω–∞–±–ª—é–¥–∞–ª–∏ –∏ —Å–Ω—è–ª–∏ –Ω–∞ –≤–∏–¥–µ–æ —Å–ª–µ–¥ –®–∞—Ç—Ç–ª–∞ –ø–æ—Å–ª–µ –≤—ã–≤–µ–¥–µ–Ω–∏—è, –¥—ã–º–∏—Ç –æ–Ω –ø—Ä–∏–ª–∏—á–Ω–æ.
# –ì–æ—Ç–æ–≤–∏–º—Å—è –∫ —Ä–∞–¥–∏–æ–ª—é–±–∏—Ç–µ–ª—å—Å–∫–æ–π —Å–≤—è–∑–∏ —Å —ç–∫–∏–ø–∞–∂–µ–º –®–∞—Ç—Ç–ª–∞ –∏, –∫–æ–Ω–µ—á–Ω–æ, —Å –°–µ—Ä–≥–µ–µ–º.
# –ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ —Å–µ–∞–Ω—Å—É —Å–≤—è–∑–∏ —Å –®–∞—Ç—Ç–ª–æ–º –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª—Å—è —Å –†–∏—Ç–æ–π, —Ä–∞–¥–∏–æ–ª—é–±–∏—Ç–µ–ª–µ–º –∏–∑ –ê–≤—Å—Ç—Ä–∞–ª–∏–∏.
# –û–Ω–∞ –Ω–µ–º–Ω–æ–≥–æ –≥–æ–≤–æ—Ä–∏—Ç –ø–æ-—Ä—É—Å—Å–∫–∏ –∏ –æ—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ —Å–ª—ã—à–∞—Ç—å —Ä–æ–¥–Ω—É—é —Ä–µ—á—å.

# 12.02.1994; 17:17
# –°–µ–≥–æ–¥–Ω—è –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–±—Ä–æ—Å–æ–º —á–µ—Ä–µ–∑ —Å–ø—É—Ç–Ω–∏–∫ —Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä –≤–∏–¥–µ–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–Ω—è—Ç–æ–º—É –Ω–∞–º–∏ —Å–ª–µ–¥—É –®–∞—Ç—Ç–ª–∞.
# –ö–∞–∫ —Å–æ–æ–±—â–∏–ª –Ω–∞–º –¶–£–ü, –≤ –©–µ–ª–∫–æ–≤–µ —Ö–æ–ª–æ–¥–Ω–æ, –≤—Å–µ –∑–∞–º–µ—Ä–∑–ª–æ, –∞–Ω—Ç–µ–Ω–Ω–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç...
# –í—Å–µ —ç—Ç–æ –Ω–∞–≤–æ–¥–∏—Ç –Ω–∞ –≥—Ä—É—Å—Ç–Ω—ã–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –æ –Ω–∞—à–µ–π –±–µ–∑–æ–ª–∞–±–µ—Ä–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑—Ä—É—Ö–µ.

# 13.02.1994; 18:49
# –£–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –Ω–∞–±–ª—é–¥–∞–µ–º –Ω–∞ —Ç–µ–Ω–µ–≤–æ–π —á–∞—Å—Ç–∏ –æ—Ä–±–∏—Ç—ã –≤ —Ä–∞–π–æ–Ω–µ –ö–∞–Ω–∞–¥—ã –º–æ—â–Ω–µ–π—à–µ–µ –ø–æ–ª—è—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ.
# –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –ø–æ—Ä–∞–∂–∞—é—Ç –º–∞—Å—à—Ç–∞–±—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–≥–æ. –ü–æ–¥ –Ω–∞–º–∏ –æ–≥—Ä–æ–º–Ω–∞—è –∑–µ–ª–µ–Ω–æ-—Ä–æ–∑–æ–≤–∞—è ¬´–∑–º–µ—è¬ª.

from datetime import datetime

with open('D:/Python/Stepik/diary.txt', 'r', encoding='utf-8') as diary:
    diary_list = list(map(str.strip, diary.readlines()))
    diary_matrix = []
    record_diary = []

    for line in diary_list:
        if bool(line):
            record_diary.append(line)
            if line == diary_list[-1]:
                diary_matrix.append(record_diary)
        else:
            diary_matrix.append(record_diary)
            record_diary = []

    for part in diary_matrix:
        part[0] = datetime.strptime(' '.join(part[0].split('; ')), '%d.%m.%Y %H:%M')
    
    sorted_diary = sorted(diary_matrix, key=lambda x: x[0])

    for record in sorted_diary:
        record[0] = record[0].strftime('%d.%m.%Y; %H:%M')
        record[-1] = f'{record[-1]}\n'
        print(*record, sep='\n')



# –§—É–Ω–∫—Ü–∏—è is_available_date() üå∂Ô∏è
# –í–æ –≤—Ä–µ–º—è –≤–∏–∑–∏—Ç–∞ –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ –≥–æ—Å—Ç—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –æ—Ç–µ–ª—è –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –¥–æ—Å—Ç—É–ø–Ω–∞
# –ª–∏ —Ç–∞ –∏–ª–∏ –∏–Ω–∞—è –¥–∞—Ç–∞ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–∞.

# –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é is_available_date(), –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º
# –ø–æ—Ä—è–¥–∫–µ:

# booked_dates ‚Äî —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –¥–∞—Ç, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –≠–ª–µ–º–µ–Ω—Ç–æ–º —Å–ø–∏—Å–∫–∞
# —è–≤–ª—è–µ—Ç—Å—è –ª–∏–±–æ –æ–¥–∏–Ω–æ—á–Ω–∞—è –¥–∞—Ç–∞, –ª–∏–±–æ –ø–µ—Ä–∏–æ–¥ (–¥–≤–µ –¥–∞—Ç—ã —á–µ—Ä–µ–∑ –¥–µ—Ñ–∏—Å). –ù–∞–ø—Ä–∏–º–µ—Ä:

# ['04.11.2021', '05.11.2021-09.11.2021']

# date_for_booking ‚Äî –æ–¥–∏–Ω–æ—á–Ω–∞—è —Å—Ç—Ä–æ–∫–æ–≤–∞—è –¥–∞—Ç–∞ –∏–ª–∏ –ø–µ—Ä–∏–æ–¥ (–¥–≤–µ –¥–∞—Ç—ã —á–µ—Ä–µ–∑ –¥–µ—Ñ–∏—Å), –Ω–∞
# –∫–æ—Ç–æ—Ä—É—é –≥–æ—Å—Ç—å –∂–µ–ª–∞–µ—Ç –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä. –ù–∞–ø—Ä–∏–º–µ—Ä:

# '01.11.2021' –∏–ª–∏ '01.11.2021-04.11.2021'

# –§—É–Ω–∫—Ü–∏—è is_available_date() –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å True, –µ—Å–ª–∏ –¥–∞—Ç–∞ –∏–ª–∏ –ø–µ—Ä–∏–æ–¥ date_for_booking
# –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å False.

# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –≤ –ø–µ—Ä–∏–æ–¥–µ –ª–µ–≤–∞—è –¥–∞—Ç–∞ –≤—Å–µ–≥–¥–∞ –º–µ–Ω—å—à–µ –ø—Ä–∞–≤–æ–π.

# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –í —Ç–µ—Å—Ç–∏—Ä—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É —Å–¥–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, —Å–æ–¥–µ—Ä–∂–∞—â—É—é —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é
# —Ñ—É–Ω–∫—Ü–∏—é is_available_date(), –Ω–æ –Ω–µ –∫–æ–¥, –≤—ã–∑—ã–≤–∞—é—â–∏–π –µ–µ.

from datetime import datetime, timedelta

def is_available_date(booked_dates, date_for_booking):
    
    def creating_dates_set(processed_dates):
        dates_set = set()
        for date in processed_dates:
            if '-' not in date:
                dates_set.add(datetime.strptime(date, '%d.%m.%Y'))
            else:
                date_interval = list(map(lambda x: datetime.strptime(x, '%d.%m.%Y'), date.split('-')))
                start_date, end_date = date_interval[0], date_interval[1]
                delta = end_date - start_date
                for i in range(delta.days + 1):
                    date = start_date + timedelta(i)
                    dates_set.add(date)
        return dates_set
    
    booked_dates_set = creating_dates_set(booked_dates)
    available_dates_set = creating_dates_set(date_for_booking.split(', '))
    
    if booked_dates_set.intersection(available_dates_set):
        return False
    else:
        return True